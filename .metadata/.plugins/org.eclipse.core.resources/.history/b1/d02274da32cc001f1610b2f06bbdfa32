/*
 * mymain.c
 *
 *  Created on: Jan 6, 2025
 *      Author: yassine.mesbahi
 */


void setup()
{
	FDCAN_TxHeaderTypeDef header;
	/******************* NE PAS TOUCHER **************************************/
	header.ErrorStateIndicator = FDCAN_ESI_ACTIVE;
	header.BitRateSwitch = FDCAN_BRS_OFF;
	header.FDFormat = FDCAN_CLASSIC_CAN;
	header.TxEventFifoControl = FDCAN_NO_TX_EVENTS;
	header.MessageMarker = 0;
	/*************************************************************************/

	header.Identifier = 0x700; // Set your CAN identifier
	TxHeader.IdType = FDCAN_STANDARD_ID; // Standard ID
    TxHeader.TxFrameType = FDCAN_DATA_FRAME; // Data frame
	    TxHeader.DataLength = 16; // Data length
	    TxHeader.BitRateSwitch = FDCAN_BRS_OFF; // Bit rate switch
	    TxHeader.FDFormat = FDCAN_CLASSIC_CAN; // Classic CAN format


		uint8_t Txdata [2] ;
}

void loop()
{
	if (-220<set_angle()&& set_angle()<220)
		{vitesse_m_s = 1.0;}
			else
			{vitesse_m_s=0.5;}

		hexa_vitesse = 0x200*(vitesse_m_s/0.35);
		Txdata [1] = set_angle() ;
		Txdata [2] = hexa_vitesse ;


	HAL_FDCAN_AddMessageToTxFifoQ(&hfdcan1,&TxHeader,&Txdata) ;
	{

}
